<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–§–æ—Ä–º–∞</title>
</head>
<body>
    <h2>–§–æ—Ä–º–∞</h2>
    <form id="userForm">
        <label>–Ü–º'—è:</label>
        <input type="text" id="firstName" required><br><br>

        <label>–ü—Ä—ñ–∑–≤–∏—â–µ:</label>
        <input type="text" id="lastName" required><br><br>

        <label>–í—ñ–∫:</label>
        <input type="number" id="age" required><br><br>

        <label>–ü–∞—Ä–æ–ª—å:</label>
        <input type="password" id="password" required>
        <button type="button" onclick="togglePassword()">üëÅ</button><br><br>

        <fieldset>
            <legend>–ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è:</legend>
            <input type="checkbox" name="hobby" value="–°–ø–æ—Ä—Ç"> –°–ø–æ—Ä—Ç
            <input type="checkbox" name="hobby" value="–ú—É–∑–∏–∫–∞"> –ú—É–∑–∏–∫–∞
            <input type="checkbox" name="hobby" value="–ü–æ–¥–æ—Ä–æ–∂—ñ"> –ü–æ–¥–æ—Ä–æ–∂—ñ
            <input type="checkbox" name="hobby" value="–ß–∏—Ç–∞–Ω–Ω—è"> –ß–∏—Ç–∞–Ω–Ω—è
            <input type="checkbox" name="hobby" value="–Ü–Ω—à–µ" onclick="toggleOtherHobby(this)"> –Ü–Ω—à–µ:
            <input type="text" id="otherHobby" style="display:none;"><br>
        </fieldset><br>

        <label>–ö—Ä–∞—ó–Ω–∞:</label>
        <select id="country" onchange="updateCities()"></select>
        <input type="text" id="customCountry" placeholder="–í–≤–µ–¥—ñ—Ç—å —Å–≤–æ—é –∫—Ä–∞—ó–Ω—É" style="display:none;"><br><br>

        <label>–ú—ñ—Å—Ç–æ:</label>
        <select id="city"></select>
        <input type="text" id="customCity" placeholder="–í–≤–µ–¥—ñ—Ç—å —Å–≤–æ—î –º—ñ—Å—Ç–æ" style="display:none;"><br><br>

        <label>–ö–æ–º–µ–Ω—Ç–∞—Ä:</label><br>
        <textarea id="comment" rows="4" cols="50"></textarea><br><br>

        <button type="submit">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
        <button type="reset">–û—á–∏—Å—Ç–∏—Ç–∏</button>
    </form>

    <script>
        const countries = {
            "–£–∫—Ä–∞—ó–Ω–∞": ["–ö–∏—ó–≤", "–õ—å–≤—ñ–≤", "–û–¥–µ—Å–∞", "–•–∞—Ä–∫—ñ–≤"],
            "–ü–æ–ª—å—â–∞": ["–í–∞—Ä—à–∞–≤–∞", "–ö—Ä–∞–∫—ñ–≤", "–í—Ä–æ—Ü–ª–∞–≤"],
            "–ù—ñ–º–µ—á—á–∏–Ω–∞": ["–ë–µ—Ä–ª—ñ–Ω", "–ú—é–Ω—Ö–µ–Ω", "–ö–µ–ª—å–Ω"],
            "–Ü—Ç–∞–ª—ñ—è": ["–†–∏–º", "–ú—ñ–ª–∞–Ω", "–ù–µ–∞–ø–æ–ª—å"],
            "–Ü–Ω—à–µ": []
        };

        const countrySelect = document.getElementById("country");
        const citySelect = document.getElementById("city");

        for (let country in countries) {
            const opt = document.createElement("option");
            opt.value = country;
            opt.text = country;
            countrySelect.appendChild(opt);
        }

        function updateCities() {
            const selected = countrySelect.value;
            const customInput = document.getElementById("customCountry");
            const cityInput = document.getElementById("customCity");

            if (selected === "–Ü–Ω—à–µ") {
                customInput.style.display = "inline";
                citySelect.style.display = "none";
                cityInput.style.display = "inline";
            } else {
                customInput.style.display = "none";
                cityInput.style.display = "none";
                citySelect.style.display = "inline";
                citySelect.innerHTML = "";
                countries[selected].forEach(city => {
                    const option = document.createElement("option");
                    option.text = city;
                    option.value = city;
                    citySelect.appendChild(option);
                });
            }
        }

        function togglePassword() {
            const input = document.getElementById("password");
            input.type = input.type === "password" ? "text" : "password";
        }

        function toggleOtherHobby(checkbox) {
            document.getElementById("otherHobby").style.display = checkbox.checked ? "inline" : "none";
        }

        document.getElementById("userForm").onsubmit = function(e) {
            e.preventDefault();

            const data = {
                firstName: document.getElementById("firstName").value,
                lastName: document.getElementById("lastName").value,
                age: document.getElementById("age").value,
                country: countrySelect.value === "–Ü–Ω—à–µ" ? document.getElementById("customCountry").value : countrySelect.value,
                city: countrySelect.value === "–Ü–Ω—à–µ" ? document.getElementById("customCity").value : citySelect.value,
                hobbies: Array.from(document.querySelectorAll('input[name="hobby"]:checked')).map(cb => cb.value).join(", ") + (document.getElementById("otherHobby").value || ""),
                comment: document.getElementById("comment").value
            };

            const saved = JSON.parse(localStorage.getItem("users") || "[]");
            saved.push(data);
            localStorage.setItem("users", JSON.stringify(saved));

            alert("–ó–±–µ—Ä–µ–∂–µ–Ω–æ!");
            this.reset();
            document.getElementById("otherHobby").style.display = "none";
            updateCities();
        };

        updateCities();
    </script>
</body>
</html>